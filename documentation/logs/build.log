[0KRunning with gitlab-runner 16.5.0 (853330f9)[0;m
[0K  on docker-runner t7dxdYPM, system ID: r_EdOxTOzg5hT6[0;m
section_start:1700855585:prepare_executor[0K[0K[36;1mPreparing the "docker" executor[0;m[0;m
[0KUsing Docker executor with image ubuntu:23.10 ...[0;m
[0KPulling docker image ubuntu:23.10 ...[0;m
[0KUsing docker image sha256:fe7a3960a97ee41f84c8045700d2e5bd671a42f02a64ee33dde10627dee1a7d7 for ubuntu:23.10 with digest ubuntu@sha256:4c32aacd0f7d1d3a29e82bee76f892ba9bb6a63f17f9327ca0d97c3d39b9b0ee ...[0;m
section_end:1700855589:prepare_executor[0Ksection_start:1700855589:prepare_script[0K[0K[36;1mPreparing environment[0;m[0;m
Running on runner-t7dxdypm-project-1-concurrent-0 via 014c685ddbef...
section_end:1700855590:prepare_script[0Ksection_start:1700855590:get_sources[0K[0K[36;1mGetting source from Git repository[0;m[0;m
[32;1mFetching changes with git depth set to 20...[0;m
Reinitialized existing Git repository in /builds/root/rnvako/.git/
[32;1mChecking out 107623fe as detached HEAD (ref is project)...[0;m
Removing .scannerwork/
Removing .sonar/
Removing gateway/.gradle/
Removing gateway/build/
Removing monitor/.gradle/
Removing monitor/build/
Removing service2/.gradle/
Removing service2/build/

[32;1mSkipping Git submodules setup[0;m
section_end:1700855592:get_sources[0Ksection_start:1700855592:step_script[0K[0K[36;1mExecuting "step_script" stage of the job script[0;m[0;m
[0KUsing docker image sha256:fe7a3960a97ee41f84c8045700d2e5bd671a42f02a64ee33dde10627dee1a7d7 for ubuntu:23.10 with digest ubuntu@sha256:4c32aacd0f7d1d3a29e82bee76f892ba9bb6a63f17f9327ca0d97c3d39b9b0ee ...[0;m
[32;1m$ echo "Compiling services and publishing to local registry..."[0;m
Compiling services and publishing to local registry...
[32;1m$ chmod +x ./setup-docker.sh && ./setup-docker.sh[0;m
Get:1 http://security.ubuntu.com/ubuntu mantic-security InRelease [109 kB]
Get:2 http://archive.ubuntu.com/ubuntu mantic InRelease [256 kB]
Get:3 http://security.ubuntu.com/ubuntu mantic-security/main amd64 Packages [131 kB]
Get:4 http://security.ubuntu.com/ubuntu mantic-security/multiverse amd64 Packages [4791 B]
Get:5 http://security.ubuntu.com/ubuntu mantic-security/restricted amd64 Packages [162 kB]
Get:6 http://security.ubuntu.com/ubuntu mantic-security/universe amd64 Packages [36.9 kB]
Get:7 http://archive.ubuntu.com/ubuntu mantic-updates InRelease [109 kB]
Get:8 http://archive.ubuntu.com/ubuntu mantic-backports InRelease [90.7 kB]
Get:9 http://archive.ubuntu.com/ubuntu mantic/restricted amd64 Packages [180 kB]
Get:10 http://archive.ubuntu.com/ubuntu mantic/multiverse amd64 Packages [293 kB]
Get:11 http://archive.ubuntu.com/ubuntu mantic/universe amd64 Packages [18.8 MB]
Get:12 http://archive.ubuntu.com/ubuntu mantic/main amd64 Packages [1808 kB]
Get:13 http://archive.ubuntu.com/ubuntu mantic-updates/main amd64 Packages [155 kB]
Get:14 http://archive.ubuntu.com/ubuntu mantic-updates/restricted amd64 Packages [162 kB]
Get:15 http://archive.ubuntu.com/ubuntu mantic-updates/universe amd64 Packages [47.7 kB]
Get:16 http://archive.ubuntu.com/ubuntu mantic-updates/multiverse amd64 Packages [4791 B]
Fetched 22.4 MB in 3s (6896 kB/s)
Reading package lists...
debconf: delaying package configuration, since apt-utils is not installed

You may press Ctrl+C now to abort this script.
+ sleep 0
+ sh -c apt-get update -qq >/dev/null
+ sh -c DEBIAN_FRONTEND=noninteractive apt-get install -y -qq apt-transport-https ca-certificates curl gnupg >/dev/null
debconf: delaying package configuration, since apt-utils is not installed
+ sh -c install -m 0755 -d /etc/apt/keyrings
+ sh -c curl -fsSL "https://download.docker.com/linux/ubuntu/gpg" | gpg --dearmor --yes -o /etc/apt/keyrings/docker.gpg
+ sh -c chmod a+r /etc/apt/keyrings/docker.gpg
+ sh -c echo "deb [arch=amd64 signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu mantic stable" > /etc/apt/sources.list.d/docker.list
+ sh -c apt-get update -qq >/dev/null
+ sh -c DEBIAN_FRONTEND=noninteractive apt-get install -y -qq docker-ce docker-ce-cli containerd.io docker-compose-plugin docker-ce-rootless-extras docker-buildx-plugin >/dev/null
debconf: delaying package configuration, since apt-utils is not installed
+ sh -c docker version
[32;1m$ docker compose build[0;m
#0 building with "default" instance using docker driver

#1 [broker internal] load .dockerignore
#1 transferring context: 2B done
#1 DONE 0.1s

#2 [gateway internal] load .dockerignore
#2 transferring context: 2B done
#2 DONE 0.1s

#3 [prometheus internal] load build definition from Dockerfile
#3 transferring dockerfile: 163B done
#3 DONE 0.1s

#4 [broker internal] load build definition from Dockerfile
#4 transferring dockerfile: 473B 0.0s done
#4 DONE 0.1s

#5 [prometheus internal] load .dockerignore
#5 transferring context: 2B done
#5 DONE 0.1s

#6 [gateway internal] load build definition from Dockerfile
#6 transferring dockerfile: 978B done
#6 DONE 0.2s

#7 [broker internal] load metadata for docker.io/library/rabbitmq:3.12.6-management-alpine
#7 DONE 0.0s

#8 [gateway internal] load metadata for docker.io/bellsoft/alpaquita-linux-base:latest
#8 DONE 0.0s

#9 [broker 1/5] FROM docker.io/library/rabbitmq:3.12.6-management-alpine
#9 DONE 0.0s

#10 [broker internal] load build context
#10 transferring context: 3.07kB done
#10 DONE 0.0s

#11 [broker 4/5] COPY run.sh /usr/local/bin/docker-entrypoint.sh
#11 CACHED

#12 [broker 2/5] COPY ./rabbitmq.conf /etc/rabbitmq/rabbitmq.conf
#12 CACHED

#13 [broker 3/5] COPY ./definitions.json /etc/rabbitmq/definitions.json
#13 CACHED

#14 [broker 5/5] RUN chmod +x /usr/local/bin/docker-entrypoint.sh
#14 CACHED

#15 [broker] exporting to image
#15 exporting layers done
#15 writing image sha256:e0a3426e6a238926ec97b9d6f3971e9aa9d2fdb69d5020f5165e147d08006c48 done
#15 naming to docker.io/library/rnvako-broker done
#15 DONE 0.0s

#16 [prometheus internal] load metadata for docker.io/prom/prometheus:v2.48.0
#16 ...

#17 [service1 internal] load build definition from Dockerfile
#17 transferring dockerfile: 760B done
#17 DONE 0.1s

#18 [service2 internal] load build definition from Dockerfile
#18 transferring dockerfile: 978B 0.1s done
#18 DONE 0.2s

#19 [service2 internal] load .dockerignore
#19 transferring context: 2B done
#19 DONE 0.3s

#8 [service2 internal] load metadata for docker.io/bellsoft/alpaquita-linux-base:latest
#8 DONE 0.0s

#20 [service1 internal] load .dockerignore
#20 transferring context: 2B done
#20 DONE 0.1s

#21 [service1 internal] load metadata for docker.io/library/rust:1.72
#21 DONE 0.0s

#22 [monitor internal] load .dockerignore
#22 transferring context: 2B done
#22 DONE 0.1s

#23 [monitor internal] load build definition from Dockerfile
#23 transferring dockerfile: 779B 0.0s done
#23 DONE 0.1s

#24 [monitor internal] load metadata for docker.io/library/eclipse-temurin:17-jre-alpine
#24 DONE 1.4s

#16 [prometheus internal] load metadata for docker.io/prom/prometheus:v2.48.0
#16 DONE 2.0s

#25 [prometheus 1/2] FROM docker.io/prom/prometheus:v2.48.0@sha256:b440bc0e8aa5bab44a782952c09516b6a50f9d7b2325c1ffafac7bc833298e2e
#25 DONE 0.0s

#26 [prometheus internal] load build context
#26 transferring context: 200B done
#26 DONE 0.1s

#27 [monitor internal] load metadata for docker.io/library/eclipse-temurin:17-jdk
#27 DONE 2.2s

#28 [monitor stage-1 1/2] FROM docker.io/library/eclipse-temurin:17-jre-alpine@sha256:984703da8353d0a33eb04944b56665e84c6271e5d4f8a679e73cb5bd2b846301
#28 DONE 0.0s

#29 [monitor internal] load build context
#29 DONE 0.0s

#30 [prometheus 2/2] COPY ./prometheus.yml /etc/prometheus/prometheus.yml
#30 CACHED

#31 [prometheus] exporting to image
#31 exporting layers done
#31 writing image sha256:f28101f778646fef447a536ee53b739469d40c58d2bf809d411da61480adae9b done
#31 naming to docker.io/library/rnvako-prometheus done
#31 DONE 0.0s

#32 [gateway stage-1 1/3] FROM docker.io/bellsoft/alpaquita-linux-base
#32 DONE 0.0s

#33 [service2 builder 1/9] FROM docker.io/library/eclipse-temurin:17-jdk@sha256:ad6772e9844819032ddf606c1eb0d62df32c16dd14fb809c1543f0529cfff580
#33 resolve docker.io/library/eclipse-temurin:17-jdk@sha256:ad6772e9844819032ddf606c1eb0d62df32c16dd14fb809c1543f0529cfff580 0.0s done
#33 DONE 0.1s

#34 [gateway internal] load build context
#34 ...

#29 [monitor internal] load build context
#29 transferring context: 88.12kB 0.0s done
#29 DONE 0.1s

#35 [service2 internal] load build context
#35 transferring context: 77.53kB 0.0s done
#35 DONE 0.1s

#34 [gateway internal] load build context
#34 transferring context: 83.50kB 0.0s done
#34 DONE 0.2s

#36 [service1 internal] load metadata for docker.io/library/debian:bookworm-20230904-slim
#36 ...

#37 [monitor builder 8/8] RUN ["./gradlew", "bootJar", "--no-daemon"]
#37 CACHED

#38 [monitor builder 3/8] COPY gradle ./gradle
#38 CACHED

#39 [monitor builder 6/8] RUN ["./gradlew", "--refresh-dependencies", "--no-daemon"]
#39 CACHED

#40 [monitor builder 5/8] RUN ["chmod", "+x", "./gradlew"]
#40 CACHED

#41 [monitor builder 4/8] COPY gradlew settings.gradle.kts build.gradle.kts gradle.properties ./
#41 CACHED

#42 [monitor builder 7/8] COPY src ./src
#42 CACHED

#43 [monitor stage-1 2/2] COPY --from=builder /home/project/build/libs/*.jar service.jar
#43 CACHED

#44 [monitor] exporting to image
#44 exporting layers done
#44 writing image sha256:5739f0b74c0dd6b48a34f5a6b13646648063fac5cbfec3f311d5b9007172e6af 0.0s done
#44 naming to docker.io/library/rnvako-monitor done
#44 DONE 0.0s

#45 [grafana internal] load .dockerignore
#45 transferring context: 2B done
#45 DONE 0.1s

#46 [grafana internal] load build definition from Dockerfile
#46 transferring dockerfile: 264B done
#46 DONE 0.1s

#47 [grafana internal] load metadata for docker.io/grafana/grafana:10.2.2
#47 DONE 0.0s

#48 [service2 builder 3/9] COPY gradle ./gradle
#48 CACHED

#49 [service2 builder 9/9] RUN ["./gradlew", "shadowJar", "--no-daemon"]
#49 CACHED

#50 [service2 builder 7/9] RUN ["./gradlew", "jre", "--no-daemon"]
#50 CACHED

#51 [service2 builder 4/9] COPY gradlew settings.gradle.kts build.gradle.kts gradle.properties ./
#51 CACHED

#52 [service2 builder 8/9] COPY src ./src
#52 CACHED

#53 [service2 builder 5/9] RUN ["chmod", "+x", "./gradlew"]
#53 CACHED

#54 [service2 stage-1 2/3] COPY --from=builder /home/project/build/jre/*-alpine-linux /jre
#54 CACHED

#55 [service2 builder 6/9] RUN ["./gradlew", "--refresh-dependencies", "--no-daemon"]
#55 CACHED

#56 [service2 stage-1 3/3] COPY --from=builder /home/project/build/libs/*-all.jar service.jar
#56 CACHED

#57 [gateway builder 5/9] RUN ["chmod", "+x", "./gradlew"]
#57 CACHED

#58 [gateway builder 3/9] COPY gradle ./gradle
#58 CACHED

#59 [gateway builder 2/9] WORKDIR /home/project
#59 CACHED

#60 [gateway builder 4/9] COPY gradlew settings.gradle.kts build.gradle.kts gradle.properties ./
#60 CACHED

#61 [gateway builder 6/9] RUN ["./gradlew", "--refresh-dependencies", "--no-daemon"]
#61 CACHED

#62 [service2] exporting to image
#62 exporting layers done
#62 writing image sha256:97889f11b5677b845be834b197bc6681d94c7a3b230de9eb67bc2388b2133bc4 done
#62 naming to docker.io/library/rnvako-service2 0.0s done
#62 DONE 0.0s

#63 [grafana 1/3] FROM docker.io/grafana/grafana:10.2.2
#63 DONE 0.0s

#36 [service1 internal] load metadata for docker.io/library/debian:bookworm-20230904-slim
#36 DONE 2.0s

#64 [service1 builder 1/5] FROM docker.io/library/rust:1.72
#64 DONE 0.0s

#65 [service1 stage-1 1/3] FROM docker.io/library/debian:bookworm-20230904-slim@sha256:050f00e86cc4d928b21de66096126fac52c2ea47885c232932b2e4c00f0c116d
#65 DONE 0.0s

#66 [grafana internal] load build context
#66 transferring context: 983.25kB 0.1s done
#66 DONE 0.1s

#67 [service1 internal] load build context
#67 transferring context: 56.73kB 0.0s done
#67 DONE 0.1s

#68 [service1 builder 2/5] COPY Cargo.toml Cargo.lock ./
#68 CACHED

#69 [service1 builder 3/5] RUN mkdir src && echo 'fn main() {}' > src/main.rs && cargo build --release
#69 CACHED

#70 [service1 builder 5/5] RUN cargo install --path .
#70 CACHED

#71 [service1 builder 4/5] COPY src ./src
#71 CACHED

#72 [service1 stage-1 2/3] RUN apt-get update && apt-get install -y --no-install-recommends libssl-dev && rm -rf /var/lib/apt/lists/*
#72 CACHED

#73 [service1 stage-1 3/3] COPY --from=builder /usr/local/cargo/bin/service1 /service1
#73 CACHED

#74 [service1] exporting to image
#74 exporting layers done
#74 writing image sha256:adcfa84dec294f6961cf1226c1d7097dc5deb611254f063cf4425369b39f8814 done
#74 naming to docker.io/library/rnvako-service1 done
#74 DONE 0.0s

#75 [grafana 2/3] COPY grafana.db /var/lib/grafana/grafana.db
#75 CACHED

#76 [grafana 3/3] RUN ["chmod", "a+w", "/var/lib/grafana/grafana.db"]
#76 CACHED

#77 [grafana] exporting to image
#77 exporting layers done
#77 writing image sha256:ffd817011a9ca8231c44acb7fa464332ebb42e62ea5134fd784aa1c3d4cb51d3 done
#77 naming to docker.io/library/rnvako-grafana done
#77 DONE 0.0s

#78 [gateway builder 7/9] RUN ["./gradlew", "jre", "--no-daemon"]
#78 2.623 To honour the JVM settings for this build a single-use Daemon process will be forked. For more on this, please refer to https://docs.gradle.org/8.4/userguide/gradle_daemon.html#sec:disabling_the_daemon in the Gradle documentation.
#78 4.323 Daemon will be stopped at the end of the build 
#78 13.83 > Task :checkKotlinGradlePluginConfigurationErrors
#78 13.83 > Task :compileKotlin NO-SOURCE
#78 13.83 > Task :compileJava NO-SOURCE
#78 13.83 > Task :processResources NO-SOURCE
#78 13.83 > Task :classes UP-TO-DATE
#78 13.92 > Task :jar
#78 48.56 > Task :jre
#78 48.83 
#78 48.83 Deprecated Gradle features were used in this build, making it incompatible with Gradle 9.0.
#78 48.83 
#78 48.83 You can use '--warning-mode all' to show the individual deprecation warnings and determine if they come from your own scripts or plugins.
#78 48.83 
#78 48.83 For more on this, please refer to https://docs.gradle.org/8.4/userguide/command_line_interface.html#sec:command_line_warnings in the Gradle documentation.
#78 48.83 
#78 48.83 BUILD SUCCESSFUL in 47s
#78 48.83 3 actionable tasks: 3 executed
#78 DONE 49.3s

#79 [gateway builder 8/9] COPY src ./src
#79 DONE 0.2s

#80 [gateway builder 9/9] RUN ["./gradlew", "shadowJar", "--no-daemon"]
#80 2.229 To honour the JVM settings for this build a single-use Daemon process will be forked. For more on this, please refer to https://docs.gradle.org/8.4/userguide/gradle_daemon.html#sec:disabling_the_daemon in the Gradle documentation.
#80 4.028 Daemon will be stopped at the end of the build 
#80 20.05 > Task :checkKotlinGradlePluginConfigurationErrors
#80 29.45 > Task :processResources
#80 38.95 > Task :compileKotlin
#80 38.95 > Task :compileJava NO-SOURCE
#80 38.95 > Task :classes
#80 45.14 > Task :shadowJar
#80 46.24 
#80 46.24 Deprecated Gradle features were used in this build, making it incompatible with Gradle 9.0.
#80 46.24 
#80 46.24 You can use '--warning-mode all' to show the individual deprecation warnings and determine if they come from your own scripts or plugins.
#80 46.24 
#80 46.24 For more on this, please refer to https://docs.gradle.org/8.4/userguide/command_line_interface.html#sec:command_line_warnings in the Gradle documentation.
#80 46.24 
#80 46.24 BUILD SUCCESSFUL in 45s
#80 46.24 4 actionable tasks: 4 executed
#80 DONE 47.1s

#81 [gateway stage-1 2/3] COPY --from=builder /home/project/build/jre/*-alpine-linux /jre
#81 CACHED

#82 [gateway stage-1 3/3] COPY --from=builder /home/project/build/libs/*-all.jar service.jar
#82 DONE 3.3s

#83 [gateway] exporting to image
#83 exporting layers
#83 exporting layers 0.1s done
#83 writing image sha256:5bcc00cf63e0965988ca9942d32f478084d0b1d5537145e54e03f43221e4bad6 done
#83 naming to docker.io/library/rnvako-gateway done
#83 DONE 0.2s
section_end:1700855748:step_script[0K[32;1mJob succeeded[0;m
