[0KRunning with gitlab-runner 16.5.0 (853330f9)[0;m
[0K  on docker-runner t7dxdYPM, system ID: r_EdOxTOzg5hT6[0;m
section_start:1700610291:prepare_executor[0K[0K[36;1mPreparing the "docker" executor[0;m[0;m
[0KUsing Docker executor with image ubuntu:23.10 ...[0;m
[0KPulling docker image ubuntu:23.10 ...[0;m
[0KUsing docker image sha256:fe7a3960a97ee41f84c8045700d2e5bd671a42f02a64ee33dde10627dee1a7d7 for ubuntu:23.10 with digest ubuntu@sha256:4c32aacd0f7d1d3a29e82bee76f892ba9bb6a63f17f9327ca0d97c3d39b9b0ee ...[0;m
section_end:1700610294:prepare_executor[0Ksection_start:1700610294:prepare_script[0K[0K[36;1mPreparing environment[0;m[0;m
Running on runner-t7dxdypm-project-1-concurrent-0 via 9662099686cb...
section_end:1700610296:prepare_script[0Ksection_start:1700610296:get_sources[0K[0K[36;1mGetting source from Git repository[0;m[0;m
[32;1mFetching changes with git depth set to 20...[0;m
Reinitialized existing Git repository in /builds/root/rnvako/.git/
[32;1mChecking out 802f1152 as detached HEAD (ref is project)...[0;m
Removing docker-setup.sh
Removing gateway/.gradle/
Removing gateway/build/
Removing get-docker.sh
Removing monitor/.gradle/
Removing monitor/build/
Removing service1/target/
Removing service2/.gradle/
Removing service2/build/

[32;1mSkipping Git submodules setup[0;m
section_end:1700610298:get_sources[0Ksection_start:1700610298:step_script[0K[0K[36;1mExecuting "step_script" stage of the job script[0;m[0;m
[0KUsing docker image sha256:fe7a3960a97ee41f84c8045700d2e5bd671a42f02a64ee33dde10627dee1a7d7 for ubuntu:23.10 with digest ubuntu@sha256:4c32aacd0f7d1d3a29e82bee76f892ba9bb6a63f17f9327ca0d97c3d39b9b0ee ...[0;m
[32;1m$ echo "Setting up environment"[0;m
Setting up environment
[32;1m$ apt-get update -y && apt-get install -qq curl > /dev/null[0;m
Get:1 http://archive.ubuntu.com/ubuntu mantic InRelease [256 kB]
Get:2 http://security.ubuntu.com/ubuntu mantic-security InRelease [109 kB]
Get:3 http://archive.ubuntu.com/ubuntu mantic-updates InRelease [109 kB]
Get:4 http://archive.ubuntu.com/ubuntu mantic-backports InRelease [90.7 kB]
Get:5 http://archive.ubuntu.com/ubuntu mantic/multiverse amd64 Packages [293 kB]
Get:6 http://archive.ubuntu.com/ubuntu mantic/main amd64 Packages [1808 kB]
Get:7 http://archive.ubuntu.com/ubuntu mantic/universe amd64 Packages [18.8 MB]
Get:8 http://security.ubuntu.com/ubuntu mantic-security/main amd64 Packages [124 kB]
Get:9 http://security.ubuntu.com/ubuntu mantic-security/universe amd64 Packages [34.7 kB]
Get:10 http://security.ubuntu.com/ubuntu mantic-security/restricted amd64 Packages [162 kB]
Get:11 http://security.ubuntu.com/ubuntu mantic-security/multiverse amd64 Packages [4791 B]
Get:12 http://archive.ubuntu.com/ubuntu mantic/restricted amd64 Packages [180 kB]
Get:13 http://archive.ubuntu.com/ubuntu mantic-updates/multiverse amd64 Packages [4791 B]
Get:14 http://archive.ubuntu.com/ubuntu mantic-updates/main amd64 Packages [145 kB]
Get:15 http://archive.ubuntu.com/ubuntu mantic-updates/restricted amd64 Packages [162 kB]
Get:16 http://archive.ubuntu.com/ubuntu mantic-updates/universe amd64 Packages [44.0 kB]
Fetched 22.4 MB in 2s (11.5 MB/s)
Reading package lists...
debconf: delaying package configuration, since apt-utils is not installed
[32;1m$ curl -fsSL https://get.docker.com -o get-docker.sh && sed 's/sleep [0-9]\+/sleep 0/g' ./get-docker.sh > docker-setup.sh && sh ./docker-setup.sh > /dev/null[0;m

You may press Ctrl+C now to abort this script.
+ sleep 0
+ sh -c apt-get update -qq >/dev/null
+ sh -c DEBIAN_FRONTEND=noninteractive apt-get install -y -qq apt-transport-https ca-certificates curl gnupg >/dev/null
debconf: delaying package configuration, since apt-utils is not installed
+ sh -c install -m 0755 -d /etc/apt/keyrings
+ sh -c curl -fsSL "https://download.docker.com/linux/ubuntu/gpg" | gpg --dearmor --yes -o /etc/apt/keyrings/docker.gpg
+ sh -c chmod a+r /etc/apt/keyrings/docker.gpg
+ sh -c echo "deb [arch=amd64 signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu mantic stable" > /etc/apt/sources.list.d/docker.list
+ sh -c apt-get update -qq >/dev/null
+ sh -c DEBIAN_FRONTEND=noninteractive apt-get install -y -qq docker-ce docker-ce-cli containerd.io docker-compose-plugin docker-ce-rootless-extras docker-buildx-plugin >/dev/null
debconf: delaying package configuration, since apt-utils is not installed
+ sh -c docker version
[32;1m$ apt-get install -qq cargo libssl-dev pkg-config openjdk-17-jdk > /dev/null[0;m
debconf: delaying package configuration, since apt-utils is not installed
[32;1m$ echo "Running integration tests..."[0;m
Running integration tests...
[32;1m$ GATEWAY_PORT=8088 docker compose -p testing-env up -d --build --wait && sleep 5[0;m
#0 building with "default" instance using docker driver

#1 [broker internal] load .dockerignore
#1 transferring context: 2B done
#1 DONE 0.1s

#2 [gateway internal] load build definition from Dockerfile
#2 transferring dockerfile: 978B done
#2 DONE 0.1s

#3 [gateway internal] load .dockerignore
#3 transferring context: 2B done
#3 DONE 0.1s

#4 [broker internal] load build definition from Dockerfile
#4 transferring dockerfile: 203B 0.0s done
#4 DONE 0.1s

#5 [gateway internal] load metadata for docker.io/bellsoft/alpaquita-linux-base:latest
#5 DONE 0.0s

#6 [broker internal] load metadata for docker.io/library/rabbitmq:3.12.6-management-alpine
#6 DONE 0.0s

#7 [broker 1/3] FROM docker.io/library/rabbitmq:3.12.6-management-alpine
#7 DONE 0.0s

#8 [broker internal] load build context
#8 transferring context: 1.53kB done
#8 DONE 0.0s

#9 [broker 2/3] COPY ./rabbitmq.conf /etc/rabbitmq/rabbitmq.conf
#9 CACHED

#10 [broker 3/3] COPY ./definitions.json /etc/rabbitmq/definitions.json
#10 CACHED

#11 [broker] exporting to image
#11 exporting layers done
#11 writing image sha256:f965cc8fc634995d016d24efa61011e4876f4618140d45abffe7227587076de9 done
#11 naming to docker.io/library/testing-env-broker done
#11 DONE 0.0s

#12 [gateway internal] load metadata for docker.io/library/eclipse-temurin:17-jdk
#12 ...

#13 [service2 internal] load build definition from Dockerfile
#13 transferring dockerfile: 978B done
#13 DONE 0.1s

#14 [service2 internal] load .dockerignore
#14 transferring context: 2B done
#14 DONE 0.1s

#5 [service2 internal] load metadata for docker.io/bellsoft/alpaquita-linux-base:latest
#5 DONE 0.0s

#15 [monitor internal] load build definition from Dockerfile
#15 transferring dockerfile: 779B 0.0s done
#15 DONE 0.1s

#12 [service2 internal] load metadata for docker.io/library/eclipse-temurin:17-jdk
#12 ...

#16 [monitor internal] load .dockerignore
#16 transferring context: 2B done
#16 DONE 0.1s

#17 [service1 internal] load .dockerignore
#17 transferring context: 2B done
#17 DONE 0.1s

#18 [service1 internal] load build definition from Dockerfile
#18 transferring dockerfile: 760B done
#18 DONE 0.1s

#19 [service1 internal] load metadata for docker.io/library/rust:1.72
#19 DONE 0.0s

#12 [monitor internal] load metadata for docker.io/library/eclipse-temurin:17-jdk
#12 DONE 0.9s

#20 [gateway stage-1 1/3] FROM docker.io/bellsoft/alpaquita-linux-base
#20 DONE 0.0s

#21 [gateway builder 1/9] FROM docker.io/library/eclipse-temurin:17-jdk@sha256:ad6772e9844819032ddf606c1eb0d62df32c16dd14fb809c1543f0529cfff580
#21 resolve docker.io/library/eclipse-temurin:17-jdk@sha256:ad6772e9844819032ddf606c1eb0d62df32c16dd14fb809c1543f0529cfff580 0.0s done
#21 DONE 0.0s

#22 [gateway internal] load build context
#22 transferring context: 74.48kB 0.0s done
#22 DONE 0.1s

#21 [monitor builder 1/9] FROM docker.io/library/eclipse-temurin:17-jdk@sha256:ad6772e9844819032ddf606c1eb0d62df32c16dd14fb809c1543f0529cfff580
#21 resolve docker.io/library/eclipse-temurin:17-jdk@sha256:ad6772e9844819032ddf606c1eb0d62df32c16dd14fb809c1543f0529cfff580 0.0s done
#21 DONE 0.0s

#23 [monitor internal] load metadata for docker.io/library/eclipse-temurin:17-jre-alpine
#23 DONE 0.4s

#24 [service2 internal] load build context
#24 transferring context: 76.94kB 0.0s done
#24 DONE 0.1s

#25 [monitor stage-1 1/2] FROM docker.io/library/eclipse-temurin:17-jre-alpine@sha256:984703da8353d0a33eb04944b56665e84c6271e5d4f8a679e73cb5bd2b846301
#25 DONE 0.0s

#26 [monitor internal] load build context
#26 transferring context: 80.58kB 0.0s done
#26 DONE 0.0s

#27 [service1 internal] load metadata for docker.io/library/debian:bookworm-20230904-slim
#27 ...

#28 [service2 builder 7/9] RUN ["./gradlew", "jre", "--no-daemon"]
#28 CACHED

#29 [service2 builder 9/9] RUN ["./gradlew", "shadowJar", "--no-daemon"]
#29 CACHED

#30 [service2 builder 8/9] COPY src ./src
#30 CACHED

#31 [service2 builder 5/9] RUN ["chmod", "+x", "./gradlew"]
#31 CACHED

#32 [service2 builder 3/9] COPY gradle ./gradle
#32 CACHED

#33 [service2 builder 6/9] RUN ["./gradlew", "--refresh-dependencies", "--no-daemon"]
#33 CACHED

#34 [service2 builder 4/9] COPY gradlew settings.gradle.kts build.gradle.kts gradle.properties ./
#34 CACHED

#35 [service2 stage-1 2/3] COPY --from=builder /home/project/build/jre/*-alpine-linux /jre
#35 CACHED

#36 [service2 stage-1 3/3] COPY --from=builder /home/project/build/libs/*-all.jar service.jar
#36 CACHED

#37 [monitor builder 6/8] RUN ["./gradlew", "--refresh-dependencies", "--no-daemon"]
#37 CACHED

#38 [monitor builder 7/8] COPY src ./src
#38 CACHED

#39 [monitor builder 4/8] COPY gradlew settings.gradle.kts build.gradle.kts gradle.properties ./
#39 CACHED

#40 [monitor builder 5/8] RUN ["chmod", "+x", "./gradlew"]
#40 CACHED

#41 [monitor builder 8/8] RUN ["./gradlew", "bootJar", "--no-daemon"]
#41 CACHED

#42 [monitor builder 3/8] COPY gradle ./gradle
#42 CACHED

#43 [monitor stage-1 2/2] COPY --from=builder /home/project/build/libs/*.jar service.jar
#43 CACHED

#44 [gateway builder 4/9] COPY gradlew settings.gradle.kts build.gradle.kts gradle.properties ./
#44 CACHED

#45 [gateway builder 6/9] RUN ["./gradlew", "--refresh-dependencies", "--no-daemon"]
#45 CACHED

#46 [gateway builder 8/9] COPY src ./src
#46 CACHED

#47 [monitor builder 2/9] WORKDIR /home/project
#47 CACHED

#48 [gateway builder 7/9] RUN ["./gradlew", "jre", "--no-daemon"]
#48 CACHED

#49 [gateway builder 5/9] RUN ["chmod", "+x", "./gradlew"]
#49 CACHED

#50 [gateway builder 3/9] COPY gradle ./gradle
#50 CACHED

#51 [gateway stage-1 2/3] COPY --from=builder /home/project/build/jre/*-alpine-linux /jre
#51 CACHED

#52 [gateway builder 9/9] RUN ["./gradlew", "shadowJar", "--no-daemon"]
#52 CACHED

#53 [gateway stage-1 3/3] COPY --from=builder /home/project/build/libs/*-all.jar service.jar
#53 CACHED

#54 [service2] exporting to image
#54 exporting layers done
#54 writing image sha256:e43a6abadf63b6d9464cd3594f278948e7dd967f73309efbcd8cc8eab9f45821 0.1s done
#54 naming to docker.io/library/testing-env-service2 done
#54 DONE 0.1s

#55 [monitor] exporting to image
#55 exporting layers done
#55 writing image sha256:ce327634617042092686d43ca1e6c57e61df1e134cdca750403b2d98de415fc7 0.0s done
#55 naming to docker.io/library/testing-env-monitor 0.0s done
#55 DONE 0.1s

#56 [gateway] exporting to image
#56 exporting layers done
#56 writing image sha256:c448678814dd41208eaa1468b081c8670edec7254f8f60f9c0df6c989601aeef 0.0s done
#56 naming to docker.io/library/testing-env-gateway done
#56 DONE 0.1s

#27 [service1 internal] load metadata for docker.io/library/debian:bookworm-20230904-slim
#27 DONE 2.6s

#57 [service1 stage-1 1/3] FROM docker.io/library/debian:bookworm-20230904-slim@sha256:050f00e86cc4d928b21de66096126fac52c2ea47885c232932b2e4c00f0c116d
#57 DONE 0.0s

#58 [service1 builder 1/5] FROM docker.io/library/rust:1.72
#58 DONE 0.0s

#59 [service1 internal] load build context
#59 transferring context: 36.13kB done
#59 DONE 0.0s

#60 [service1 builder 4/5] COPY src ./src
#60 CACHED

#61 [service1 builder 5/5] RUN cargo install --path .
#61 CACHED

#62 [service1 builder 2/5] COPY Cargo.toml Cargo.lock ./
#62 CACHED

#63 [service1 builder 3/5] RUN mkdir src && echo 'fn main() {}' > src/main.rs && cargo build --release
#63 CACHED

#64 [service1 stage-1 2/3] RUN apt-get update && apt-get install -y --no-install-recommends libssl-dev && rm -rf /var/lib/apt/lists/*
#64 CACHED

#65 [service1 stage-1 3/3] COPY --from=builder /usr/local/cargo/bin/service1 /service1
#65 CACHED

#66 [service1] exporting to image
#66 exporting layers done
#66 writing image sha256:d08bfc8174863c1d84e5f7abbcff8d351ea4e4579b97c39fe1347f6a0271c433 done
#66 naming to docker.io/library/testing-env-service1 done
#66 DONE 0.0s
 Network testing-env_default  Creating
 Network testing-env_default  Created
 Network testing-env_internal  Creating
 Network testing-env_internal  Created
 Container testing-env-gateway-1  Creating
 Container testing-env-broker-1  Creating
 Container testing-env-broker-1  Created
 Container testing-env-monitor-1  Creating
 Container testing-env-service1-1  Creating
 Container testing-env-service2-1  Creating
 Container testing-env-gateway-1  Created
 Container testing-env-monitor-1  Created
 Container testing-env-service2-1  Created
 Container testing-env-service1-1  Created
 Container testing-env-gateway-1  Starting
 Container testing-env-broker-1  Starting
 Container testing-env-broker-1  Started
 Container testing-env-broker-1  Waiting
 Container testing-env-broker-1  Waiting
 Container testing-env-broker-1  Waiting
 Container testing-env-gateway-1  Started
 Container testing-env-broker-1  Healthy
 Container testing-env-monitor-1  Starting
 Container testing-env-broker-1  Healthy
 Container testing-env-service2-1  Starting
 Container testing-env-broker-1  Healthy
 Container testing-env-service1-1  Starting
 Container testing-env-monitor-1  Started
 Container testing-env-service2-1  Started
 Container testing-env-service1-1  Started
 Container testing-env-service2-1  Waiting
 Container testing-env-broker-1  Waiting
 Container testing-env-monitor-1  Waiting
 Container testing-env-gateway-1  Waiting
 Container testing-env-service1-1  Waiting
 Container testing-env-service2-1  Healthy
 Container testing-env-gateway-1  Healthy
 Container testing-env-broker-1  Healthy
 Container testing-env-service1-1  Healthy
 Container testing-env-monitor-1  Healthy
[32;1m$ docker build -t api-tester ./tests && docker run --rm --network testing-env_default api-tester[0;m
#0 building with "default" instance using docker driver

#1 [internal] load .dockerignore
#1 transferring context: 2B done
#1 DONE 0.0s

#2 [internal] load build definition from Dockerfile
#2 transferring dockerfile: 360B done
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/schemathesis/schemathesis:v3.21.0-buster
#3 DONE 0.0s

#4 [internal] load build context
#4 transferring context: 3.00kB done
#4 DONE 0.0s

#5 [1/2] FROM docker.io/schemathesis/schemathesis:v3.21.0-buster
#5 CACHED

#6 [2/2] COPY apis /apis
#6 DONE 0.0s

#7 exporting to image
#7 exporting layers 0.0s done
#7 writing image sha256:bed9667d590d995eb991e90b7ffa954c9c7450449973ef1ac983c4673b999b59 done
#7 naming to docker.io/library/api-tester done
#7 DONE 0.0s
WARNING: The provided hosts.toml file location is unusable - using a temporary file for this session. path='/home/schemathesis/.config/schemathesis/hosts.toml'
======================= Schemathesis test session starts =======================
Schema location: file:///apis/openapi.yml
Base URL: http://gateway
Specification version: Open API 3.0.3
Workers: 1
Collected API operations: 5

GET /messages .                                                           [ 20%]
GET /state .                                                              [ 40%]
PUT /state F                                                              [ 60%]
GET /run-log .                                                            [ 80%]
GET /mqstatistic .                                                        [100%]

=================================== FAILURES ===================================
__________________________________ PUT /state __________________________________
1. Test Case ID: v4640c

- Undocumented HTTP status code

    Received: 405
    Documented: 200, 400

[405] Method Not Allowed:

    <EMPTY>

Reproduce with: 

    curl -X PUT -H 'Content-Type: text/plain' -d PAUSED http://gateway/state

Or add this option to your command line parameters: --hypothesis-seed=335200301386091417693946201851378604515
=================================== SUMMARY ====================================

Performed checks:
    not_a_server_error                              5 / 5 passed          PASSED 
    status_code_conformance                         4 / 5 passed          FAILED 
    content_type_conformance                        5 / 5 passed          PASSED 
    response_headers_conformance                    5 / 5 passed          PASSED 
    response_schema_conformance                     5 / 5 passed          PASSED 

Note: Use the 'X-Schemathesis-TestCaseId' header to correlate test case ids from failure messages with server logs for debugging.

Tip: Use the `--report` CLI option to visualize test results via Schemathesis.io.
We run additional conformance checks on reports from public repos.

========================= 4 passed, 1 failed in 0.99s ==========================
section_end:1700610422:step_script[0Ksection_start:1700610422:after_script[0K[0K[36;1mRunning after_script[0;m[0;m
[32;1mRunning after script...[0;m
[32;1m$ docker compose -p testing-env down[0;m
 Container testing-env-gateway-1  Stopping
 Container testing-env-service1-1  Stopping
 Container testing-env-service2-1  Stopping
 Container testing-env-monitor-1  Stopping
 Container testing-env-monitor-1  Stopped
 Container testing-env-monitor-1  Removing
 Container testing-env-monitor-1  Removed
 Container testing-env-service2-1  Stopped
 Container testing-env-service2-1  Removing
 Container testing-env-service2-1  Removed
 Container testing-env-gateway-1  Stopped
 Container testing-env-gateway-1  Removing
 Container testing-env-gateway-1  Removed
 Container testing-env-service1-1  Stopped
 Container testing-env-service1-1  Removing
 Container testing-env-service1-1  Removed
 Container testing-env-broker-1  Stopping
 Container testing-env-broker-1  Stopped
 Container testing-env-broker-1  Removing
 Container testing-env-broker-1  Removed
 Network testing-env_internal  Removing
 Network testing-env_default  Removing
 Network testing-env_internal  Removed
 Network testing-env_default  Removed
section_end:1700610442:after_script[0K[31;1mERROR: Job failed: exit code 1
[0;m
